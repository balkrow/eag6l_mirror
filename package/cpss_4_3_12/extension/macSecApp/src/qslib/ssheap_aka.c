/**
   
   @copyright
   Copyright (c) 2002 - 2013, Rambus Inc. All rights reserved.
   
   ssheap_aka.c
   
*/


#include "sshincludes.h"
#include "sshbuffer.h"
#include "sshcrypt.h"
#include "ssheap.h"
#include "ssheapi.h"
#include "ssheap_packet.h"
#include "ssheap_aka.h"

#define SSH_DEBUG_MODULE "SshEapAka"







































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































void
ssh_eap_aka_recv_params(SshEapProtocol protocol,
                        SshEap eap,
                        SshBuffer buf)
{



























}

void* ssh_eap_aka_create(SshEapProtocol protocol, 
                         SshEap eap, SshUInt8 type)
{













  return NULL;

}

void
ssh_eap_aka_destroy(SshEapProtocol protocol, 
                    SshUInt8 type, void *state)
{






















}

SshEapOpStatus
ssh_eap_aka_signal(SshEapProtocolSignalEnum sig,
                   SshEap eap,
                   SshEapProtocol protocol,
                   SshBuffer buf)
{

































































  return SSH_EAP_OPSTATUS_SUCCESS;
}

SshEapOpStatus
ssh_eap_aka_key(SshEapProtocol protocol, 
                SshEap eap, SshUInt8 type)
{
  SSH_ASSERT(protocol != NULL);
  SSH_ASSERT(eap != NULL);
  SSH_ASSERT(eap->is_authenticator == TRUE);

  if (eap->mppe_send_keylen < 32 || eap->mppe_recv_keylen < 32)
    {
      SSH_DEBUG(SSH_D_FAIL, ("Keys too short %d %d", 
                             eap->mppe_send_keylen, 
                             eap->mppe_recv_keylen));
      return SSH_EAP_OPSTATUS_FAILURE;
    }
  
  if ((eap->msk = ssh_malloc(64)) == NULL)
    return SSH_EAP_OPSTATUS_FAILURE;

  eap->msk_len = 64;
  
  memcpy(eap->msk, eap->mppe_recv_key, 32);
  memcpy(eap->msk + 32, eap->mppe_send_key, 32);
  
  SSH_DEBUG_HEXDUMP(SSH_D_MIDOK, ("64 byte EAP-AKA MSK"),
                    eap->msk, eap->msk_len);
 
  return SSH_EAP_OPSTATUS_SUCCESS;
}
